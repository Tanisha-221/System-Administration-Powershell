Set-Item WSMan:\localhost\Client\TrustedHosts -Value "*" -Force

Restart-Service WinRM

New-PSSession -ComputerName Vm1 -Credential (Get-Credential)

$session = New-PSSession -ComputerName Vm1 -Credential (Get-Credential)

# Define source and destination
$remotePath = "C:\Assignment_1\*"    # all files and folders inside Assignment_1
$localPath  = "C:\report\Vm1_Assignment_1"  # include VM name to avoid conflicts

# Make sure local folder exists
if (-not (Test-Path $localPath)) {
    New-Item -Path $localPath -ItemType Directory | Out-Null
}

Copy-Item -FromSession $session -Path "C:\Assignment_1" -Destination "C:\report" -Recurse -Force -Verbose